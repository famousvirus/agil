!function(e,t){"use strict";e.module("jett.ionic.scroll.sista",["ionic"]).directive("scrollSista",["$document","$timeout","$rootScope","$ionicScrollDelegate",function(a,n,r,o){function i(e,t,a,n){var r;for(n=n||10;e.parentNode&&n--;){if(r=e.parentNode.getAttribute(t),r&&r===a)return e.parentNode;e=e.parentNode}return null}var c=400,l=2*c,s=c+"ms",u=t.Platform.isAndroid()?!1:!0;return{restrict:"A",link:function(r,c,f){function d(e,a,r){r&&!e.style[t.CSS.TRANSITION_DURATION]&&(e.style[t.CSS.TRANSITION_DURATION]=r,n(function(){e.style[t.CSS.TRANSITION_DURATION]=""},l,!1)),e.style[t.CSS.TRANSFORM]="translate3d(0, "+-a+"px, 0)"}function b(){N=0,v=0,$=0}function h(){var e;if(y=q.querySelector('[nav-bar="cached"] .bar-header'),A=q.querySelector('[nav-bar="active"] .bar-header'))switch(T=A.offsetHeight,g=T,I=q.querySelectorAll(".tabs"),I=I[I.length-1],I&&(k=I.offsetHeight,I.parentNode.classList.contains("tabs-top")?(E=!0,g+=k):I.parentNode.classList.contains("tabs-bottom")&&(F=!0)),e=i(c[0],"nav-view","active"),M=e.querySelector(".bar-subheader"),M&&(R=M.offsetHeight,g+=R),x=2*g,O=w=C=x,k=k||0,R=R||0,f.scrollSista){case"header":C=T,w=E?T:0;break;case"header-tabs":L=E?k:0,C=E?T+k:T;break;case"tabs-subheader":O=0,L=E?g-T:R,U=E?R:0;break;case"tabs":O=0,C=E?k:0;break;case"subheader":O=0,w=0;break;case"header-subheader":w=E?T:0;break;case"subheader-header":L=R,U=E?R:0,w=E?T:0;break;default:L=E?g-T:R,U=E?R:0}}function S(a,n){var r=Math.max(0,1-a/T);d(A,a,n),e.forEach(A.children,function(e){e.style.opacity=r,u&&(e.style[t.CSS.TRANSFORM]="scale("+r+","+r+")")}),d(y,a,n)}function p(e,t){var a,n,r=c[0].style,o=e>L?e-L:0;M&&(n=e>_?e-_:0,d(M,Math.min(C,n),t)),I&&(a=Math.min(w,e>U?e-U:0),F&&(a=-a,r.bottom=Math.max(0,k-e)+"px"),d(I,a,t)),S(Math.min(O,o),t),r.top=Math.max(0,g-e)+"px"}function m(e,a){t.requestAnimationFrame(function(){p(e,a)})}var N,v,$,y,A,T,g,M,R,I,k,x,O,w,C,H=!0,q=a[0].body,D=f.delegateHandle?o.$getByHandle(f.delegateHandle):o,V=D.getScrollView(),E=!1,F=!1,L=0,U=0,_=0;r.$on("scroll.refreshComplete",function(){b()}),r.$parent.$on("$ionicView.beforeLeave",function(){H=!0,p(0),A=null,y=null}),r.$parent.$on("$ionicView.beforeEnter",function(){D&&D.scrollTop()}),r.$parent.$on("$ionicView.afterEnter",function(){b(),n(function(){h(),H=!1},20,!1)}),c.bind("scroll",function(e){if(!H){var t=0,a=e.detail.scrollTop;N=a>=0?Math.min(x,Math.max(0,N+a-$)):0,V.getScrollMax().top-a<=g&&(N=0,t=s),$=a,v!==N&&(v=N,m(N,t))}})}}}])}(angular,ionic);